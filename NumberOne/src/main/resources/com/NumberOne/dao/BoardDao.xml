<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
 <mapper namespace ="com.NumberOne.dao.BoardDao">
 	
 	<select id="selectNoticeList" resultType="com.NumberOne.dto.NoticeDto">
 		<!-- 공지 게시글 목록 조회 -->
 		SELECT NBCODE,NBMID,NBTITLE,NBCONTENTS,TO_CHAR(NBDATE,'YY-MM-DD') AS NBDATE,
 			   NBIMG,NBSTATE,NBHITS 
 		FROM NOTICEBOARDS
 	</select>
 	
 	<select id="selectBoardSearchList" resultType="com.NumberOne.dto.BoardDto">
 		<!-- 글검색 결과 조회 -->
 		SELECT BD.*, MB.MNICKNAME AS BDNICKNAME 
 		FROM BOARDS BD, MEMBERS MB
 		WHERE BD.BDMID = MB.MID 
 		
 		<if test="searchType == 'bdtitle' ">
 		<!-- 제목으로 검색 -->
 		AND BDTITLE LIKE '%'||#{searchText}||'%'
 		</if>
 		
 		<if test="searchType == 'bdcontents'">
 		<!-- 내용으로 검색 -->
 		AND BDCONTENTS LIKE '%'||#{searchText}||'%'
 		</if>
 		
 		<if test="searchType == 'bdtitlecontents'">
 		<!-- 제목 + 내용으로 검색  -->
 		AND BDTITLE LIKE '%'||#{searchText}||'%'
 		OR BDCONTENTS LIKE '%'||#{searchText}||'%'
 		</if>
 		
 		<if test="searchType == 'bdnickname'">
 		<!-- 닉네임으로 검색 -->
 		AND BDNICKNAME LIKE '%'||#{searchText}||'%'
 		</if>
 		
 		ORDER BY BDCODE DESC
 	 </select>
 	 
 	 <select id="selectNoticeBoardView" resultType="com.NumberOne.dto.NoticeDto">
	 	 <!-- 공지글 상세 -->
	 	 SELECT NBCODE,NBMID,NBTITLE,NBCONTENTS,TO_CHAR(NBDATE,'YY-MM-DD HH24:MI') AS NBDATE,
 			   NBIMG,NBSTATE,NBHITS  
	 	 FROM NOTICEBOARDS
	 	 WHERE NBCODE = #{nbcode}
 	 </select>
 	 
 	 <select id="selectBoardView" resultType="com.NumberOne.dto.BoardDto">
 	 	<!-- 일반글 상세 -->
 	 	SELECT BDCODE, BDRGCODE, BDCATEGORY, BDMID, BDTITLE, BDCONTENTS, TO_CHAR(BDDATE,'YY-MM-DD HH24:MI') AS BDDATE, 
	    BDIMG, BDDETAILIMG, BDSTATE, BDHITS, MB.MNICKNAME AS BDNICKNAME
		FROM BOARDS BD, MEMBERS MB
		WHERE BD.BDMID = MB.MID
		AND BD.BDCODE = #{bdcode}
 	 </select>
 	 
 	 
 </mapper>